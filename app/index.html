<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <title>edit</title>
  </head>
  <body>
    <div class="menu">
        <div class="subject">
            <span>项目</span>
            <a @click="project.open()" href="#">打开</a>
            <a @click="project.new()" href="#">新建</a>
            <a @click="project.save(project.path)" href="#">保存</a>
            <span v-text="project.path || '未打开文件'"></span>
        </div>
    </div>
    <div v-for="subject in project.subjects" class="subject">
        <div class="head">
            <span>主题：</span>
            <span v-text="subject.name"></span>
            <input type="text" @keyup.enter="subject.add()" v-model="subject.input"/>
            <a @click="subject.add()" href="#">添加todo</a>
            <a @click="subject.empty()" href="#">清空</a>
            <a @click="project.delSubject(subject)" href="#">删除</a>
        </div>
        <div class="body">
            <table>
                <tr>
                    <th>内容</th>
                    <th>时间</th>
                    <th>操作</th>
                </tr>
                <template v-for="(index, item) in subject.todos">
                    <tr>
                        <td >
                            <textarea v-model="item.content"></textarea>
                        </td>
                        <td >
                            <p v-text="item.time.split(' ')[0]"></p>
                            <p v-text="item.time.split(' ')[1]"></p>
                        </td>
                        <td>
                            <a @click="subject.del(item)" href="#">删除</a>
                        </td>
                    </tr>
                </template>
            </table>
        </div>
    </div>
    <div class="todo">
        <input type="text" @keyup.enter ="project.addSubject()" v-model="project.input"/>
        <a @click="project.addSubject()" href="#">添加主题</a>
    </div>
    <div class="history">
        <a @click="project.history.empty()" href="#">清空历史</a>
        <div v-for="item in project.history.logs | orderBy 'time' -1" >
            <span v-text="item.action"></span>
            <span v-text="item.success?'成功':'失败'"></span>
            <span v-if="item.action == 'project_open'" >
                <a v-text="item.data.filename" @click="project.open(item.data.filename)" href="#"></a>
            </span>
            <span v-if="item.data.error" v-text="item.data.error.message"></span>
            <span v-text="item.time"></span>
        </div>
    </div>
  <script>
    // You can also require other files to run in this process
      require('./renderer.js')
  </script>
  </body>

</html>
